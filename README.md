# GameVault - Backend

[![Java](https://img.shields.io/badge/Java-17+-orange.svg)](https://www.oracle.com/java/)
[![Spring Boot](https://img.shields.io/badge/Spring_Boot-3.2+-6DB33F.svg)](https://spring.io/projects/spring-boot)
[![Kafka](https://img.shields.io/badge/Apache_Kafka-3.x-blue.svg)](https://kafka.apache.org/)

Backend веб-приложения **GameVault** для учёта пройденных игр, ведения заметок и анализа игровой активности.

> **Frontend** находится в отдельном репозитории:
> [GameVault-frontend](https://github.com/TyanVsharfe/GameVault-frontend)

## Основной функционал
### Управление пользователями
- Управление сессиями (логин/логаут)
- Проверка активной сессии
- Поддержка Remember Me
- Статистика (игры/достижения)

### Учёт игр
- Добавление игр по IGDB ID
- Управление статусами игр:
  - `Playing`, `Played`, `Planned`, `Completed`, `Abandoned`, `None`
  - Отдельный флаг `fullyCompleted` для 100% прохождения
- Оценка игр 
- Рецензии и заметки к играм
- Поддержка разных режимов игры (singleplayer, multiplayer и т.д.)
- Фильтрация игр по статусу, жанру, платформе и другим параметрам
- Пагинация и сортировка

### Кастомные списки игр
- Создание персональных списков игр
- Копирование существующих списков
- Управление порядком игр в списках
- Добавление/удаление игр из списков
- Массовое удаление игр из списков

### Система достижений
- Получение достижений по категориям
- Пользовательские достижения с локализацией
- Административный интерфейс для создания достижений
- Автоматическое присвоение достижений за активность

### Импорт из Steam
- Получение списка игр пользователя по Steam ID
- Асинхронная обработка импорта через Kafka
- Выборочный импорт игр (с фильтрацией)
- Автоматическое заполнение метаданных

### Поиск и обогащенные данные
- Поиск игр с учетом пользовательских данных
- Получение детализированной информации об играх
- Агрегация данных из разных источников
- Поддержка пользовательских меток и оценок

---

## API (приведена часть эндпоинтов, которые есть в приложении)

### Базовый префикс
```
${api.prefix}/...
```

### Пользователи
| Метод | Эндпоинт                     | Описание                          |
|-------|------------------------------|-----------------------------------|
| POST  | `/users/registration`        | Регистрация нового пользователя   |
| POST  | `/users/login`               | Авторизация пользователя          |
| POST  | `/users/logout`              | Выход из системы                  |
| GET   | `/users/check-session`       | Проверка активной сессии          |

### Управление играми
| Метод | Эндпоинт                              | Описание                          |
|-------|----------------------------------------|-----------------------------------|
| GET   | `/users/games/{igdb-id}`               | Получить игру по IGDB ID          |
| GET   | `/users/games/{igdb-id}/reviews`       | Получить рецензии на игру         |
| GET   | `/users/games`                         | Получить все игры (с фильтрацией) |
| POST  | `/users/games/{igdb-id}`               | Добавить игру                     |
| PUT   | `/users/games/{igdb-id}`               | Полное обновление игры            |
| PATCH | `/users/games/{igdb-id}/status`        | Обновить статус игры              |
| PATCH | `/users/games/{igdb-id}/fully-completed`| Обновить флаг полного прохождения |
| PATCH | `/users/games/{igdb-id}/rating`        | Обновить оценку игры              |
| PATCH | `/users/games/{igdb-id}/review`        | Обновить рецензию                 |
| PUT   | `/users/games/{igdb-id}/modes/{mode}`  | Обновить режим игры               |
| PATCH | `/users/games/{igdb-id}/modes/{mode}/rating` | Обновить оценку режима |
| DELETE| `/users/games/{igdb-id}`               | Удалить игру                      |
| GET   | `/users/games/exists/{igdb-id}`        | Проверить наличие игры            |

Пример обновления статуса:
```json
{
  "status": "Completed"
}
```

### Кастомные списки
| Метод | Эндпоинт                              | Описание                          |
|-------|----------------------------------------|-----------------------------------|
| GET   | `/users/game-lists/{list-id}`         | Получить список по ID             |
| GET   | `/users/game-lists`                   | Получить все списки пользователя  |
| POST  | `/users/game-lists`                   | Создать новый список              |
| POST  | `/users/game-lists/{list-id}/copy`    | Копировать список                 |
| PUT   | `/users/game-lists/{list-id}`         | Обновить список                   |
| PUT   | `/users/game-lists/{list-id}/order`   | Обновить порядок игр              |
| DELETE| `/users/game-lists/{list-id}`         | Удалить список                     |
| DELETE| `/users/game-lists/{list-id}/games/{game-id}` | Удалить игру из списка |
| DELETE| `/users/game-lists/{list-id}/games`   | Массовое удаление игр из списка   |

Пример создания списка:
```json
{
  "name": "Любимые игры",
  "description": "Список моих любимых игр",
  "isPublic": true
}
```

### Достижения
| Метод | Эндпоинт                              | Описание                          |
|-------|----------------------------------------|-----------------------------------|
| GET   | `/users/achievements/category/{category}` | Получить достижения по категории |
| GET   | `/users/achievements`                 | Получить все достижения пользователя |
| POST  | `/users/achievements`                 | Создать достижение (ADMIN)        |

### Импорт из Steam
| Метод | Эндпоинт                              | Описание                          |
|-------|----------------------------------------|-----------------------------------|
| POST  | `/steam-import/{steam-id}`            | Запустить импорт игр из Steam      |
| GET   | `/steam-import/{steam-id}`            | Получить список игр из Steam      |

Пример запроса на импорт:
```json
[
  123456,
  789012
]
```

### Обогащенные данные
| Метод | Эндпоинт                              | Описание                          |
|-------|----------------------------------------|-----------------------------------|
| GET   | `/games/enriched/search`              | Поиск игр с пользовательскими данными |
| GET   | `/games/enriched/game-lists/{list-id}`| Получить список с обогащенными данными |
| GET   | `/games/enriched/{igdbId}`            | Получить игру с обогащенными данными |

---

## Запуск локально

1. Убедитесь, что установлены:
   - JDK 17+
   - Maven
   - Docker (опционально, для Kafka и PostgreSQL)

2. Настройте конфигурацию в `src/main/resources/application.yml`

3. Сборка и запуск:
```bash
./mvnw clean spring-boot:run
```

4. API доступно по адресу: `http://localhost:8080/api/v1`
